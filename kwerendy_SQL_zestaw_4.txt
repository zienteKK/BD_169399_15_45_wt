//zad 1
use wikingowie;
SELECT AVG(waga) AS srednia_waga FROM kreatura where rodzaj = 'wiking';
SELECT rodzaj, COUNT(rodzaj) AS liczba_kreatur, AVG(waga) as srednia_waga FROM kreatura GROUP BY rodzaj;
SELECT ROUND(AVG(1700 - YEAR(dataUr)), 2) AS sredni_wiek FROM kreatura;
//SELECT ROUND(AVG(YEAR(CURDATE()) - YEAR(dataUr)), 2) AS sredni_wiek FROM kreatura;

//zad 2
SELECT rodzaj, SUM(waga) as laczna_waga FROM zasob GROUP by rodzaj;

SELECT nazwa, ROUND(AVG(waga), 2) as srednia_waga  from zasob GROUP BY nazwa HAVING  SUM(ilosc) >=4 AND SUM(waga) > 10;

//SELECT nazwa,ROUND( AVG(waga),2) AS srednia_waga FROM zasob WHERE ilosc >= '4' AND (SELECT SUM(waga) FROM zasob) > '10' GROUP BY nazwa;

SELECT rodzaj, count(distinct(nazwa)) FROM zasob GROUP BY rodzaj HAVING count(distinct(nazwa)) > 1;


//zad 3
SELECT kreatura.nazwa, zasob.idZasobu  FROM kreatura LEFT JOIN ekwipunek ON ekwipunek.idKreatury = kreatura.idKreatury JOIN zasob ON zasob.idZasobu = ekwipunek.idZasobu;


SELECT kreatura.nazwa, ekwipunek.idZasobu as ekwipunek, zasob.idZasobu, zasob.nazwa FROM kreatura  JOIN ekwipunek ON ekwipunek.idKreatury = kreatura.idKreatury LEFT JOIN zasob ON zasob.idZasobu = ekwipunek.idZasobu;

SELECT kreatura.nazwa, ekwipunek.idZasobu FROM kreatura LEFT JOIN ekwipunek ON ekwipunek.idKreatury = kreatura.idKreatury HAVING idZasobu IS NULL;


